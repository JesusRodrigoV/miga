<div class="container">
  <div class="header">
    <h2>Parte 4: Pon en Marcha</h2>
    <p class="subtitle">Comienza con tu negocio ahora.</p>
  </div>

  <form [formGroup]="form" (ngSubmit)="onSubmit()" class="smart-form">
    <div class="form-fields">
      <mg-textarea
        label="1. Identificación de los aliados"
        formControlName="aliados"
        [rows]="4"
        [fluid]="true"
        [invalid]="isInvalid('aliados')"
        errorMessage="La identificación de aliados es requerida."
      />

      <mg-textarea
        label="2. Identificación de clientes"
        formControlName="clientes"
        [rows]="4"
        [fluid]="true"
        [invalid]="isInvalid('clientes')"
        errorMessage="La identificación de clientes es requerida."
      />

      <mg-textarea
        label="3. Identificación de la competencia"
        formControlName="competencia"
        [rows]="4"
        [fluid]="true"
        [invalid]="isInvalid('competencia')"
        errorMessage="La identificación de la competencia es requerida."
      />

      <mg-textarea
        label="4. Puntos de distribución"
        formControlName="puntosDistribucion"
        [rows]="4"
        [fluid]="true"
        [invalid]="isInvalid('puntosDistribucion')"
        errorMessage="Los puntos de distribución son requeridos."
      />

      <mg-textarea
        label="5. Estrategias de mercadeo (promoción o difusión)"
        formControlName="mercadeo"
        [rows]="4"
        [fluid]="true"
        [invalid]="isInvalid('mercadeo')"
        errorMessage="Las estrategias de mercadeo son requeridas."
      />
    </div>
    <div class="form-actions">
      <mg-button
        [buttonProps]="{ type: 'submit' }"
        [loading]="store.isLoading()"
        [disabled]="form.invalid || store.isLoading()"
        [fluid]="false"
        [color]="'var(--verde-medio)'"
        [hoverColor]="'var(--black)'"
        [textColor]="'var(--white)'"
      >
        @if(store.isLoading()) {
        <mg-loader />
        } @else {
        <span>Finalizar Plan</span>
        }
      </mg-button>
    </div>
  </form>

  @if (store.isSaved()) {
    <div class="success-area">
      <p>¡Felicidades! Has completado tu plan.</p>

      <mg-button
        label="Ver mis planes"
        [routerLink]="['/planes']"
        severity="success"
        [fluid]="false"
        icon="pi pi-file-pdf"
        [color]="'var(--verde-oscuro)'"
        [hoverColor]="'var(--black)'"
        [textColor]="'var(--white)'"
      />
    </div>
  }
</div>
